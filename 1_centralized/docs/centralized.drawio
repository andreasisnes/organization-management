<mxfile host="app.diagrams.net" modified="2024-05-06T13:08:59.392Z" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36" etag="yNq3m1OzWvL0surE4cYU" version="24.3.1" type="device">
  <diagram name="Page-1" id="__NgVeajK4GgIgE01n2E">
    <mxGraphModel dx="1627" dy="759" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="CHkc7mHs2D5SORGemX9Y-1" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="160" width="1280" height="720" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-2" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="50" y="210" width="620" height="660" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-4" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="690" y="210" width="620" height="660" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-5" value="Solution 1: Centralized (Team Infrastructure Owners)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="460" y="170" width="440" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-7" value="GitHub" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.github_code;pointerEvents=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="220" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-8" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="330" width="600" height="530" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-9" value="Altinn" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="240" y="260" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-10" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="70" y="410" width="580" height="440" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-11" value="Altinn / Teams / Team Infrastructure" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="220" y="360" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-12" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="80" y="470" width="560" height="370" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-13" value="Repository: &lt;b&gt;altinn-repositories&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="260" y="430" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-15" value="" style="whiteSpace=wrap;html=1;shape=mxgraph.basic.document" vertex="1" parent="1">
          <mxGeometry x="90" y="480" width="280" height="350" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-18" value="configuration.yaml" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="120" y="500" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-24" value="&lt;b&gt;Create pull request&lt;br&gt;&lt;/b&gt;&lt;br&gt;Add Team or add repository to an&lt;br&gt;already existing team&amp;nbsp;" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="CHkc7mHs2D5SORGemX9Y-23">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="100" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-23" value="Altinn Developer" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#232F3D;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.user;" vertex="1" parent="1">
          <mxGeometry x="-310" y="645" width="70" height="70" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-25" value="GitHub Action&lt;br&gt;Executes on merge&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#7AA116;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.iot_analytics_pipeline;" vertex="1" parent="1">
          <mxGeometry x="470" y="480" width="78" height="42" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-30" value="&lt;div style=&quot;color: #d8dee9;background-color: #2e3440;font-family: &#39;Mononoki Nerd Font&#39;, &#39;Font Awesome 6 Free&#39;, &#39;Droid Sans Mono&#39;, &#39;Droid Sans Mono&#39;, &#39;monospace&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #8fbcbb;&quot;&gt;organization&lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a3be8c;&quot;&gt;altinn&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #8fbcbb;&quot;&gt;teams&lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #8fbcbb;&quot;&gt;name&lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a3be8c;&quot;&gt;Team Access Management&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #8fbcbb;&quot;&gt;repositories&lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a3be8c;&quot;&gt;access-management&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a3be8c;&quot;&gt;access-management-frontend&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a3be8c;&quot;&gt;authorization&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #8fbcbb;&quot;&gt;name&lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;:&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a3be8c;&quot;&gt;Team Access Information&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #8fbcbb;&quot;&gt;repositories&lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a3be8c;&quot;&gt;authentication&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt;      &lt;/span&gt;&lt;span style=&quot;color: #eceff4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d8dee9;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a3be8c;&quot;&gt;resource-registry&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="95" y="570" width="270" height="270" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-44" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="CHkc7mHs2D5SORGemX9Y-32" target="CHkc7mHs2D5SORGemX9Y-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-32" value="Entra" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.azure_active_directory;" vertex="1" parent="1">
          <mxGeometry x="700" y="220" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-33" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="470" width="600" height="390" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-35" value="App registrations" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/identity/App_Registrations.svg;" vertex="1" parent="1">
          <mxGeometry x="880" y="217.5" width="83.68" height="85" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-37" value="&lt;b&gt;Terraform Project&lt;/b&gt;&lt;br&gt;1. Reads configuration.yaml&lt;br&gt;&lt;br&gt;2. Creates App registration for each team and environment. e.g GitHub Team Access Management AT21 OIDC.&lt;br&gt;&lt;br&gt;3.&amp;nbsp; Creates federated credentials for app registrations for each belonging repository. E.g for app Team Access Information AT21 OIDC.&lt;br&gt;github.altinn.authentication.environment.at21&lt;br&gt;github.altinn.resource-registry.environment.at21&lt;br&gt;&lt;br&gt;4.&amp;nbsp;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="370" y="560" width="259" height="270" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-38" value="GitHub Apps" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.github_code;pointerEvents=1;" vertex="1" parent="1">
          <mxGeometry x="560" y="222.5" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-40" value="Identity Federation OIDC" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="CHkc7mHs2D5SORGemX9Y-25" target="CHkc7mHs2D5SORGemX9Y-35">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="509" y="440" />
              <mxPoint x="922" y="440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-47" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="CHkc7mHs2D5SORGemX9Y-45" target="CHkc7mHs2D5SORGemX9Y-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-45" value="Azure Resource Management" style="verticalLabelPosition=bottom;html=1;verticalAlign=top;align=center;strokeColor=none;fillColor=#00BEF2;shape=mxgraph.azure.cloud;" vertex="1" parent="1">
          <mxGeometry x="1100" y="220" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-46" value="Service Principal" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.05;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="CHkc7mHs2D5SORGemX9Y-35" target="CHkc7mHs2D5SORGemX9Y-45">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-48" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="710" y="530" width="580" height="320" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-50" value="Subscription: &lt;b&gt;&amp;lt;SUB&amp;gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="860" y="486" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-51" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/general/Subscriptions.svg;" vertex="1" parent="1">
          <mxGeometry x="890" y="481" width="24.79" height="40" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-52" value="Resource group: &lt;b&gt;&amp;lt;RG&amp;gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="910" y="540" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-53" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/general/Resource_Groups.svg;" vertex="1" parent="1">
          <mxGeometry x="890" y="538" width="36.13" height="34" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-54" value="" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="720" y="580" width="560" height="260" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-55" value="Installed App" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="CHkc7mHs2D5SORGemX9Y-25" target="CHkc7mHs2D5SORGemX9Y-38">
          <mxGeometry x="0.3457" relative="1" as="geometry">
            <mxPoint x="560" y="262" as="targetPoint" />
            <Array as="points">
              <mxPoint x="510" y="262" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-56" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/storage/Storage_Accounts.svg;" vertex="1" parent="1">
          <mxGeometry x="740" y="604" width="65" height="52" as="geometry" />
        </mxCell>
        <mxCell id="CHkc7mHs2D5SORGemX9Y-57" value="&lt;b&gt;Blobs&lt;br&gt;&lt;/b&gt;Name: github-{organization}-{repository}-{enbvironment}&lt;br&gt;IAM Storage Blob Owner: GitHub {Team Name} {Environment}&lt;br&gt;&lt;br&gt;E.g name: github-altinn-altinn-authorization-at21&lt;br&gt;E.g IAM&amp;nbsp;Storage Blob Owner: GitHub Team Access Management AT21&amp;nbsp;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="810" y="596" width="460" height="234" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
